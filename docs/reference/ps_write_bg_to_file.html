<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Save background statistics from a `PSMatrixList` object to a file — ps_write_bg_to_file • PscanR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Save background statistics from a `PSMatrixList` object to a file — ps_write_bg_to_file"><meta property="og:description" content="Saves background statistics (such as size, mean, and standard deviation)
for each Position Weight Matrix in a `PSMatrixList` object to a specified
file."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PscanR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Background_generation.html">How to Generate a Background Model for PscanR algorithm</a>
    </li>
    <li>
      <a href="../articles/Execution_time_cores.html">Comparing execution time with varying processors</a>
    </li>
    <li>
      <a href="../articles/PscanR_introduction.html">Introduction to PscanR</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Federico77z/PscanR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Save background statistics from a `PSMatrixList` object to a file</h1>
    <small class="dont-index">Source: <a href="https://github.com/Federico77z/PscanR/blob/HEAD/R/Build_Background.R" class="external-link"><code>R/Build_Background.R</code></a></small>
    <div class="hidden name"><code>ps_write_bg_to_file.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Saves background statistics (such as size, mean, and standard deviation)
for each Position Weight Matrix in a `PSMatrixList` object to a specified
file.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ps_write_bg_to_file</span><span class="op">(</span><span class="va">pfms</span>, <span class="va">file</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-pfms">pfms<a class="anchor" aria-label="anchor" href="#arg-pfms"></a></dt>
<dd><p>A `PSMatrixList` object of Position Weight Matrices
representing transcription factor binding preferences, obtained, for
example, from the JASPAR database.
Each matrix should already include background statistics
(e.g., computed from all promoter regions in the organism of
study). Each element must be a `PSMatrix` object or coercible to one.</p></dd>


<dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>A character string specifying the path to the output file where
the background statistics should be saved.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>None. It saves the given background statistics to the specified file
in a tab-delimited format.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function first extracts background statistics from the input `pfms`
using `ps_get_bg_table()`. It then writes the result to the specified file
in a tab-delimited format. The output file begins with a header line:
`[SHORT TFBS MATRIX]`. This header is used internally for compatibility with
`ps_retrieve_bg_from_file()`, which expects it when reading.</p>
<p>The output does not include column names; the first column contains matrix
identifiers, followed by `BG_SIZE`, `BG_MEAN`, and `BG_STDEV`.</p>
<p>This function uses example datasets located in the `extdata/` directory for
demonstration purposes only. These files are not part of the core data used
by the function. They can be accessed using `system.file()` as shown in the
examples.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ps_get_bg_table.html">ps_get_bg_table</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load the example dataset for JASPAR2020 matrices collection </span></span></span>
<span class="r-in"><span><span class="co"># for vertebrates.</span></span></span>
<span class="r-in"><span><span class="va">J2020_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"J2020.rds"</span>, package <span class="op">=</span> <span class="st">"PscanR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">J2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">J2020_path</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># File path to save the result</span></span></span>
<span class="r-in"><span><span class="va">file_path</span> <span class="op">&lt;-</span> <span class="st">"J2020_hg38_bg_stats.txt"</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">PSM1</span> <span class="op">&lt;-</span> <span class="fu"><a href="PSMatrix.html">PSMatrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  pfm <span class="op">=</span> <span class="va">J2020</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  ps_bg_avg <span class="op">=</span> <span class="fl">0.25</span>,        </span></span>
<span class="r-in"><span>  ps_fg_avg <span class="op">=</span> <span class="fl">0.5</span>,         </span></span>
<span class="r-in"><span>  ps_bg_std_dev <span class="op">=</span> <span class="fl">0.05</span>,    </span></span>
<span class="r-in"><span>  ps_bg_size <span class="op">=</span> <span class="fl">250L</span>        </span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">PSM2</span> <span class="op">&lt;-</span> <span class="fu"><a href="PSMatrix.html">PSMatrix</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  pfm <span class="op">=</span> <span class="va">J2020</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  ps_bg_avg <span class="op">=</span> <span class="fl">0.25</span>,        </span></span>
<span class="r-in"><span>  ps_fg_avg <span class="op">=</span> <span class="fl">0.5</span>,         </span></span>
<span class="r-in"><span>  ps_bg_std_dev <span class="op">=</span> <span class="fl">0.05</span>,    </span></span>
<span class="r-in"><span>  ps_bg_size <span class="op">=</span> <span class="fl">250L</span>        </span></span>
<span class="r-in"><span>  <span class="op">)</span></span></span>
<span class="r-in"><span>  </span></span>
<span class="r-in"><span><span class="va">PSMatrixList_J2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="PSMatrixList.html">PSMatrixList</a></span><span class="op">(</span><span class="va">PSM1</span>, <span class="va">PSM2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># ps_write_bg_to_file(PSMatrixList_J2020, file_path)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Federico Zambelli, Giulio Pavesi.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

