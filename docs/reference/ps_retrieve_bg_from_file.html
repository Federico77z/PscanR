<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Import background-scored matrices from a file — ps_retrieve_bg_from_file • PscanR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Import background-scored matrices from a file — ps_retrieve_bg_from_file"><meta property="og:description" content="Reconstructs a `PSMatrixList` object containing background-scored motif
matrices, using a previously computed background dataset stored in a file.
The input file must have been generated by the `ps_write_bg_to_file()`
function from a background `PSMatrixList` object."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PscanR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Background_generation.html">How to Generate a Background Model for PscanR algorithm</a>
    </li>
    <li>
      <a href="../articles/Execution_time_cores.html">Comparing execution time with varying processors</a>
    </li>
    <li>
      <a href="../articles/PscanR_introduction.html">Introduction to PscanR</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Federico77z/PscanR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Import background-scored matrices from a file</h1>
    <small class="dont-index">Source: <a href="https://github.com/Federico77z/PscanR/blob/HEAD/R/Build_Background.R" class="external-link"><code>R/Build_Background.R</code></a></small>
    <div class="hidden name"><code>ps_retrieve_bg_from_file.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Reconstructs a `PSMatrixList` object containing background-scored motif
matrices, using a previously computed background dataset stored in a file.
The input file must have been generated by the `ps_write_bg_to_file()`
function from a background `PSMatrixList` object.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ps_retrieve_bg_from_file</span><span class="op">(</span><span class="va">file</span>, <span class="va">pfms</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-file">file<a class="anchor" aria-label="anchor" href="#arg-file"></a></dt>
<dd><p>A character string with the path to the input file.
This file contains the score distribution statistics for the
frequency matrices computed on a
background set of regulatory sequences.
The file should be in tabular format, where the first column contains
the frequency matrix identifiers (row names) and subsequent columns
contain the background statistics
(e.g., BG_SIZE, BG_MEAN, BG_STDEV).
Background statistics are generated with the `ps_build_bg` function and
can be written to a file with `ps_write_bg_to_file`.</p></dd>


<dt id="arg-pfms">pfms<a class="anchor" aria-label="anchor" href="#arg-pfms"></a></dt>
<dd><p>A `PFMatrixList` object containing position frequency matrices
representing transcription factor binding preferences, obtained,
for example, from the JASPAR database.
The provided list must correspond to the same
frequency matrix list used to build the background stored in `file`.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A `PSMatrixList` object, containing each motif matrix from `pfms`,
background-scored using the values provided in `file`.
See `ps_build_bg_from_table` for more details.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This function:</p><ul><li><p>Validates the input type: must be a character string.</p></li>
<li><p>Reads the input file into a `data.frame`, with row names taken
   from the first column.</p></li>
<li><p>Calls `ps_build_bg_from_table` with the created `data.frame`
   and `pfms` as input.</p></li>
</ul><p>This function uses example datasets located in the `extdata/` directory for
demonstration purposes only. These file are not part of the core data used
by the function. They can be accessed using `system.file()` as shown in the
examples.</p>
<p>Other background datasets are aviable at the public repository
PscanR_background on GitHub:
<a href="https://github.com/dianabetelli/PscanR_backgrounds" class="external-link">https://github.com/dianabetelli/PscanR_backgrounds</a>
See vignettes for further details on the type of background available.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="ps_build_bg.html">ps_build_bg</a></code>, <code><a href="ps_write_bg_to_file.html">ps_write_bg_to_file</a></code>,
<code><a href="ps_build_bg_from_table.html">ps_build_bg_from_table</a></code></p>
<p><code><a href="ps_build_bg_from_table.html">ps_build_bg_from_table</a></code></p></div>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load a background information file</span></span></span>
<span class="r-in"><span><span class="va">file_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"J2020_hg38_200u_50d_UCSC.psbg.txt"</span>, </span></span>
<span class="r-in"><span>                         package <span class="op">=</span> <span class="st">"PscanR"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load the example dataset for JASPAR2020 matrices collection for </span></span></span>
<span class="r-in"><span><span class="co"># vertebrates.</span></span></span>
<span class="r-in"><span><span class="va">J2020_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"J2020.rds"</span>, package <span class="op">=</span> <span class="st">"PscanR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">J2020</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">J2020_path</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Generate the background-scored motif matrices from file</span></span></span>
<span class="r-in"><span><span class="va">bg_matrices</span> <span class="op">&lt;-</span> <span class="fu">ps_retrieve_bg_from_file</span><span class="op">(</span><span class="va">file_path</span>, <span class="va">J2020</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bg_matrices</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PSMatrixList of length 746</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> names(746): MA0004.1 MA0006.1 MA0019.1 MA0029.1 ... MA0748.2 MA0528.2 MA0609.2</span>
<span class="r-in"><span><span class="va">bg_matrices</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class PSMatrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ID: MA0006.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Name: Ahr::Arnt</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matrix Class: Basic helix-loop-helix factors (bHLH)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> strand: +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tags: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alias</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "-"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $comment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dimer"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $description</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "-"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $family</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "PAS domain factors"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $medline</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "7592839"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $remap_tf_name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "AHR"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $symbol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "-"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $tax_group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "vertebrates"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $tfbs_shape_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "13"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "SELEX"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $unibind</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $collection</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "CORE"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          10090 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Mus musculus" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $acc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "P30561" "P53762"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Background: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    A    C    G    T </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.25 0.25 0.25 0.25 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matrix: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         [,1]        [,2]        [,3]        [,4]        [,5]        [,6]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A -2.0417012 -4.64439090 -4.64439090 -4.64439090 -4.64439090 -4.64439090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C -1.1082742 -4.64439090 -0.07139961 -4.64439090 -4.64439090 -4.64439090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G -2.4107987 -0.07139961 -4.64439090 -0.07139961 -4.64439090 -0.02927038</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> T -0.7977957 -3.00216316 -3.00216316 -3.00216316 -0.02927038 -4.64439090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pscan Background Average: 0.8806266</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pscan Foreground (your sample) Average: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pscan Backgroun Stdev: 0.07161552</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pscan Background Size: 39438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pscan Foreground (your sample) Size: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pscan Zscore: NA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pscan pvalue (z-test): NA</span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Federico Zambelli, Giulio Pavesi.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

