<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Perform a Scan of DNA Sequences Using a `PSMatrix` Object — ps_scan,PSMatrix-method • PscanR</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Perform a Scan of DNA Sequences Using a `PSMatrix` Object — ps_scan,PSMatrix-method"><meta property="og:description" content="This method performs a scan of DNA sequences using a `PSMatrix` object
to identify potential hits based on the matrix score. The scan is
performed on both strands (the direct and reverse complement strands) of the
sequences to ensure that no potential binding sites are missed."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">PscanR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/Background_generation.html">How to Generate a Background Model for PscanR algorithm</a>
    </li>
    <li>
      <a href="../articles/Execution_time_cores.html">Comparing execution time with varying processors</a>
    </li>
    <li>
      <a href="../articles/PscanR_introduction.html">Introduction to PscanR</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/Federico77z/PscanR/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform a Scan of DNA Sequences Using a `PSMatrix` Object</h1>
    <small class="dont-index">Source: <a href="https://github.com/Federico77z/PscanR/blob/HEAD/R/methods-PSMatrix.R" class="external-link"><code>R/methods-PSMatrix.R</code></a></small>
    <div class="hidden name"><code>ps_scan-PSMatrix-method.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This method performs a scan of DNA sequences using a `PSMatrix` object
to identify potential hits based on the matrix score. The scan is
performed on both strands (the direct and reverse complement strands) of the
sequences to ensure that no potential binding sites are missed.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S4 method for class 'PSMatrix'</span></span>
<span><span class="fu"><a href="ps_scan.html">ps_scan</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">seqs</span>, BG <span class="op">=</span> <span class="cn">FALSE</span>, use_full_BG <span class="op">=</span> <span class="cn">FALSE</span>, fullBG <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A `PSMatrix` object representing the motif and related statistics
to be used for scanning DNA sequences.</p></dd>


<dt id="arg-seqs">seqs<a class="anchor" aria-label="anchor" href="#arg-seqs"></a></dt>
<dd><p>`A DNAstringSet` object representing the sequences to be
scanned for motif occurrences.</p></dd>


<dt id="arg-bg">BG<a class="anchor" aria-label="anchor" href="#arg-bg"></a></dt>
<dd><p>A logical value indicating whether to calculate background
statistics.
Default is set to `FALSE`.</p></dd>


<dt id="arg-use-full-bg">use_full_BG<a class="anchor" aria-label="anchor" href="#arg-use-full-bg"></a></dt>
<dd><p>A logical value (default is `FALSE`).
If `TRUE`, the method assumes that the PSMatrix represent a special
"full-background" set.
In this case, the `seqs` parameter should be a vector of sequence names
(instead of actual DNA sequences). The function handles this by matching
sequence names against precomputed background data in the `PSMatrix`.</p></dd>


<dt id="arg-fullbg">fullBG<a class="anchor" aria-label="anchor" href="#arg-fullbg"></a></dt>
<dd><p>Logical, default is `FALSE`. If `TRUE` it computes a series
of computation for the generation of a "full-background", a special case
of background that retains all the background hits score, position,
strand, and oligonucleotide sequence for each regulatory sequence scanned
with a PWM.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A `PSMatrix` object, with updated information about the motif hits
    in the sequences. This includes the positions, strands, scores, and
    oligos (sequence motifs) where the hits occurred.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>This method is designed to handle different types of sequence scanning
scenarios. It can handle both regular DNA sequences (using a `DNAStringSet`)
and specialized background sequence sets (either using a background flag
or a full-background flag).</p>
<p>If `use_full_BG` is set to `TRUE`, the function assumes that `seqs` contains
sequence identifiers rather than the sequences themselves. In this case, the
method matches the sequence names to those in the `PSMatrix`'s background
hit data and retrieves the corresponding binding information (score, strand,
position, oligo).</p>
<p>When `use_full_BG` is set to `FALSE`, the function scan both the forward and
reverse complement strands of the sequences to ensure all potential binding
sites are detected. Optionally, the background statistics
(background average and standard deviation) can be computed and used during
scanning when `BG` is set to `TRUE`.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">BG_matrices</span> <span class="op">&lt;-</span> <span class="fu"><a href="generate_psmatrixlist_from_background.html">generate_psmatrixlist_from_background</a></span><span class="op">(</span><span class="st">'Jaspar2020'</span>, <span class="st">'hs'</span>, </span></span>
<span class="r-in"><span>                                                     <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">200</span>,<span class="fl">50</span><span class="op">)</span>,<span class="st">'hg38'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">file_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"prom_seq.rds"</span>, package <span class="op">=</span> <span class="st">"PscanR"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">prom_seq</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="va">file_path</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">prom_seq</span> <span class="op">&lt;-</span> <span class="va">prom_seq</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">scanned_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="ps_scan.html">ps_scan</a></span><span class="op">(</span><span class="va">BG_matrices</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, <span class="va">prom_seq</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">scanned_result</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class PSMatrix</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ID: MA0019.1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Name: Ddit3::Cebpa</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matrix Class: Basic leucine zipper factors (bZIP)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> strand: +</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Tags: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $alias</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "-"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $comment</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "dimer between Ddit3 and Cebpa"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $description</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "-"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $family</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "C/EBP-related factors"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $medline</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "8657121"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $symbol</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "-"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $tax_group</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "vertebrates"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $tfbs_shape_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "26"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $type</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "SELEX"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $collection</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "CORE"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $species</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               10116 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> "Rattus norvegicus" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $acc</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Q62857" "P05554"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Background: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    A    C    G    T </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.25 0.25 0.25 0.25 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Matrix: </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        [,1]      [,2]       [,3]        [,4]        [,5]       [,6]        [,7]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A -1.036249 -1.270047 -0.7909753 -4.64439090 -4.64439090 -2.2234531 -0.05498535</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C -1.702655 -1.702655 -2.4819524 -3.37347861 -4.64439090 -0.1945259 -3.37347861</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G -1.185893 -1.036249 -0.9690644 -4.64439090 -0.05498535 -4.6443909 -4.64439090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> T -1.848048 -1.702655 -2.4819524 -0.05498535 -3.37347861 -2.8314890 -4.64439090</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>         [,8]       [,9]     [,10]      [,11]      [,12]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> A -0.1084883 -4.6443909 -1.036249 -2.2234531 -4.6443909</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> C -2.8314890 -1.8480481 -0.846887 -0.5504738 -0.4297972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> G -3.3734786 -4.6443909 -2.018237 -1.4631371 -1.8480481</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> T -4.6443909 -0.1945259 -2.481952 -2.4819524 -1.7026546</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pscan Background Average: 0.7960527</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pscan Foreground (your sample) Average: 0.79835</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pscan Backgroun Stdev: 0.04700296</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pscan Background Size: 39438</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pscan Foreground (your sample) Size: 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pscan Zscore: 0.2443804</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Pscan pvalue (z-test): 0.4034681</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Federico Zambelli, Giulio Pavesi.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

      </footer></div>






  </body></html>

